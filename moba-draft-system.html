<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema di Draft MOBA</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --blue-team: #2962ff;
            --red-team: #ff9800;
            --dark-bg: #1a252f;
            --mid-bg: #212b36;
            --slot-bg: #838b94;
            --text: #ffffff;
        }
        
        body {
            background-color: var(--dark-bg);
            color: var(--text);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }
        
        .main-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        
        /* Header delle squadre */
        .team-headers {
            display: flex;
            width: 100%;
        }
        
        .team-header {
            padding: 10px;
            text-align: center;
            font-weight: bold;
            font-size: 1.5rem;
            color: white;
        }
        
        .blue-header {
            background-color: var(--blue-team);
            width: 40%;
        }
        
        .red-header {
            background-color: var(--red-team);
            width: 40%;
        }
        
        /* Timer header centrale */
        .timer-header {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 20%;
            background-color: #333;
            font-size: 2rem;
            font-weight: bold;
            color: white;
        }
        
        .timer-header.warning {
            background-color: var(--timer-warning);
        }
        
        .timer-header.danger {
            background-color: var(--timer-danger);
        }
        
        /* Contenitore principale per le squadre e il grid centrale */
        .draft-container {
            display: flex;
            flex: 1;
        }
        
        /* Colonne squadre */
        .team-column {
            width: 25%;
            background-color: var(--mid-bg);
            display: flex;
            flex-direction: column;
        }
        
        /* Colonna centrale per i campioni */
        .champions-column {
            width: 50%;
            background-color: var(--dark-bg);
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        /* Slots per i giocatori */
        .player-slot {
            background-color: var(--slot-bg);
            height: 20%;
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid var(--dark-bg);
            position: relative;
        }
        
        .player-slot img {
            max-height: 70%;
            max-width: 70%;
        }
        
        .player-slot.selected {
            box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.5);
        }
        
        /* Nome del campione selezionato */
        .player-slot .hero-name {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px;
            text-align: center;
            font-size: 1rem;
            font-weight: bold;
        }
        
        /* Slots per i ban */
        .ban-container {
            display: flex;
            margin-top: auto;
            height: 200px;
            width: 350px;
            background-color: var(--mid-bg);
        }
        
        .ban-slot {
            width: 350px;
            background-color: var(--slot-bg);
            margin: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            position: relative;
            flex-direction: column
        }
        
        .ban-slot img {
            width: 150px;
            height: 150px;
        }
        
        .ban-slot.banned::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1;
        }
        
        .ban-slot.banned::before {
            content: 'Ã—';
            position: absolute;
            font-size: 40px;
            color: red;
            font-weight: bold;
            z-index: 2;
        }
        
        /* Griglia dei campioni */
        .champions-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-template-rows: repeat(6, 1fr);
            gap: 10px;
            margin-bottom: 20px;
            flex: 1;
        }
        
        .champion-card {
            background-color: var(--slot-bg);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            cursor: pointer;
            overflow: hidden;
        }
        
        .champion-card.empty-champion {
            background-color: #444;
            border: 2px dashed #888;
        }
        
        .champion-card img {
            max-width: 100%;
            max-height: 100%;
            object-fit: cover;
        }
        
        .champion-card.selected {
            border: 3px solid yellow;
        }
        
        .champion-card.empty-champion.selected {
            border: 3px solid yellow;
            background-color: #555;
        }
        
        .champion-card.disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }
        
        /* Pulsanti di controllo */
        .controls {
            display: flex;
            justify-content: center;
            padding: 10px;
            gap: 10px;
            background-color: var(--mid-bg);
        }
        
        .btn-draft {
            padding: 10px 20px;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            border: none;
        }
        
        .btn-blue {
            background-color: var(--blue-team);
            color: white;
        }
        
        .btn-red {
            background-color: var(--red-team);
            color: white;
        }
        
        .btn-start {
            background-color: #4CAF50;
            color: white;
            font-size: 1.2rem;
            padding: 10px 30px;
            margin-top: 10px;
        }
        
        /* Timer e indicatore di fase */
        .draft-info {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 10;
        }
        
        .timer {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .phase-indicator {
            font-size: 1.2rem;
        }
        
        /* Modal delle impostazioni */
        .modal-content {
            background-color: var(--mid-bg);
            color: var(--text);
        }
        
        .modal-header, .modal-footer {
            border-color: rgba(255, 255, 255, 0.1);
        }
        
        @media (max-width: 992px) {
            .champions-grid {
                grid-template-columns: repeat(5, 1fr);
                grid-template-rows: repeat(9, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .draft-container {
                flex-direction: column;
            }
            
            .team-column, .champions-column {
                width: 100%;
            }
            
            .team-column {
                height: 30vh;
            }
            
            .champions-column {
                height: 40vh;
            }
            
            .champions-grid {
                grid-template-columns: repeat(4, 1fr);
                grid-template-rows: repeat(11, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Header con nomi squadre e timer -->
        <div class="team-headers">
            <div class="team-header blue-header">Blu</div>
            <div class="timer-header" id="timer">30</div>
            <div class="team-header red-header">Rosso</div>
        </div>
        
        <!-- Contenitore principale per il draft -->
        <div class="draft-container">
            <!-- Colonna squadra BLU (sinistra) -->
            <div class="team-column">
                <div class="player-slot" id="bluePlayer1">
                    <img src="/api/placeholder/100/100" alt="Slot Giocatore">
                </div>
                <div class="player-slot" id="bluePlayer2">
                    <img src="/api/placeholder/100/100" alt="Slot Giocatore">
                </div>
                <div class="player-slot" id="bluePlayer3">
                    <img src="/api/placeholder/100/100" alt="Slot Giocatore">
                </div>
                <div class="player-slot" id="bluePlayer4">
                    <img src="/api/placeholder/100/100" alt="Slot Giocatore">
                </div>
                <div class="player-slot" id="bluePlayer5">
                    <img src="/api/placeholder/100/100" alt="Slot Giocatore">
                </div>
                
                <!-- Ban della squadra blu -->
                <div class="ban-container">
                    <div class="ban-slot" id="blueBan1">
                        <img src="/api/placeholder/180/180" alt="Slot Ban">
                    </div>
                    <div class="ban-slot" id="blueBan2">
                        <img src="/api/placeholder/180/180" alt="Slot Ban">
                    </div>
                </div>
            </div>
            
            <!-- Colonna centrale per la selezione dei campioni -->
            <div class="champions-column">
                <div class="champions-grid" id="championsContainer">
                    <!-- I campioni verranno generati dinamicamente -->
                </div>
                
                <button class="btn-start" id="startBtn">INIZIA DRAFT</button>
            </div>
            
            <!-- Colonna squadra ROSSA (destra) -->
            <div class="team-column">
                <div class="player-slot" id="redPlayer1">
                    <img src="/api/placeholder/100/100" alt="Slot Giocatore">
                </div>
                <div class="player-slot" id="redPlayer2">
                    <img src="/api/placeholder/100/100" alt="Slot Giocatore">
                </div>
                <div class="player-slot" id="redPlayer3">
                    <img src="/api/placeholder/100/100" alt="Slot Giocatore">
                </div>
                <div class="player-slot" id="redPlayer4">
                    <img src="/api/placeholder/100/100" alt="Slot Giocatore">
                </div>
                <div class="player-slot" id="redPlayer5">
                    <img src="/api/placeholder/100/100" alt="Slot Giocatore">
                </div>
                
                <!-- Ban della squadra rossa -->
                <div class="ban-container">
                    <div class="ban-slot" id="redBan1">
                        <img src="/api/placeholder/180/180" alt="Slot Ban">
                    </div>
                    <div class="ban-slot" id="redBan2">
                        <img src="/api/placeholder/180/180" alt="Slot Ban">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Controlli del draft -->
        <div class="controls">
            <button class="btn-draft btn-blue" id="pauseBtn">
                <i class="fas fa-pause me-2"></i>Pausa
            </button>
            <button class="btn-draft btn-red" id="resetBtn">
                <i class="fas fa-redo me-2"></i>Reset
            </button>
            <button class="btn-draft" id="settingsBtn" style="background-color: #777;">
                <i class="fas fa-cog me-2"></i>Impostazioni
            </button>
        </div>
        
        <!-- Info di fase -->
        <div class="draft-info">
            <div class="phase-indicator" id="phaseIndicator">In attesa di inizio</div>
        </div>
        
        <!-- Istruzioni a fondo pagina -->
        <div style="background-color: rgba(0,0,0,0.7); padding: 20px; margin-top: 20px; border-radius: 10px;">
            <h4 style="color: #ffb142; text-align: center; margin-bottom: 15px;">ISTRUZIONI DI DRAFT</h4>
            
            <div class="row">
                <div class="col-md-6">
                    <h5 style="color: #3498db;">Sequenza di Draft</h5>
                    <ol style="color: #ecf0f1;">
                        <li><strong>Ban iniziali</strong>: Prima Blu, poi Rosso</li>
                        <li><strong>Prima fase pick</strong>: Blu â†’ Rosso â†’ Rosso â†’ Blu â†’ Blu â†’ Rosso</li>
                        <li><strong>Ban secondari</strong>: Rosso, poi Blu</li>
                        <li><strong>Seconda fase pick</strong>: Rosso â†’ Blu â†’ Blu â†’ Rosso</li>
                    </ol>
                </div>
                
                <div class="col-md-6">
                    <h5 style="color: #3498db;">FunzionalitÃ  Speciali</h5>
                    <ul style="color: #ecf0f1;">
                        <li>Il <strong>PG Vuoto</strong> (primo personaggio nella griglia) puÃ² essere selezionato piÃ¹ volte</li>
                        <li>Il <strong>timer</strong> si puÃ² mettere in pausa e riprendere con l'apposito pulsante</li>
                        <li>Se il timer scade, verrÃ  selezionato automaticamente un personaggio casuale tra quelli disponibili</li>
                        <li>I personaggi giÃ  selezionati non sono piÃ¹ disponibili per la selezione successiva</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Impostazioni -->
    <div class="modal fade" id="settingsModal" tabindex="-1" aria-labelledby="settingsModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="settingsModalLabel">Impostazioni Draft</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="timePerPick" class="form-label">Tempo di selezione (secondi)</label>
                        <input type="number" class="form-control" id="timePerPick" value="30" min="5" max="120">
                    </div>
                    <div class="mb-3">
                        <label for="timePerBan" class="form-label">Tempo di ban (secondi)</label>
                        <input type="number" class="form-control" id="timePerBan" value="20" min="5" max="60">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Chiudi</button>
                    <button type="button" class="btn btn-primary" id="saveSettings">Salva impostazioni</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script>
        // Configurazione di base
        const config = {
            timePerPick: 30, // secondi
            timePerBan: 20,  // secondi
            totalChampions: 41,
            championsConfig: [] // SarÃ  popolato dal JSON
        };
        
        // Dati JSON di esempio per i campioni (questo verrÃ  sostituito dalla tua configurazione)
        const defaultChampionsJson = `
        [
            {
                "id": 1, 
                "name": "Argus",
                "image": "pred_icons/argus.png"
            },
            {
                "id": 2, 
                "name": "Aurora",
                "image": "pred_icons/aurora.png"
            },
            {
                "id": 3, 
                "name": "Belica",
                "image": "pred_icons/belica.png"
            },
            {
                "id": 4, 
                "name": "Countess",
                "image": "pred_icons/countess.png"
            },
            {
                "id": 5, 
                "name": "Crunch",
                "image": "pred_icons/crunch.png"
            },
            {
                "id": 6, 
                "name": "Dekker",
                "image": "pred_icons/dekker.png"
            },
            {
                "id": 7, 
                "name": "Drongo",
                "image": "pred_icons/drongo.png"
            },
            {
                "id": 8, 
                "name": "The Fey",
                "image": "pred_icons/fey.png"
            },
            {
                "id": 9, 
                "name": "Gadget",
                "image": "pred_icons/gadget.png"
            },
            {
                "id": 10, 
                "name": "Gideon",
                "image": "pred_icons/gideon.png"
            },
            {
                "id": 11, 
                "name": "Greystone",
                "image": "pred_icons/greystone.png"
            },
            {
                "id": 12, 
                "name": "Grim.EXE",
                "image": "pred_icons/grim.png"
            },
            {
                "id": 13, 
                "name": "Grux",
                "image": "pred_icons/grux.png"
            },
            {
                "id": 14, 
                "name": "Howitzer",
                "image": "pred_icons/crunch.png"
            },
            {
                "id": 15, 
                "name": "Iggy & Scorch",
                "image": "pred_icons/iggy.png"
            },
            {
                "id": 16, 
                "name": "Kallari",
                "image": "pred_icons/kallari.png"
            },
            {
                "id": 17, 
                "name": "Khaimera",
                "image": "pred_icons/khaimera.png"
            },
            {
                "id": 18, 
                "name": "Kira",
                "image": "pred_icons/kira.png"
            },
            {
                "id": 19, 
                "name": "Kwang",
                "image": "pred_icons/kwang.png"
            },
            {
                "id": 20, 
                "name": "Morigesh",
                "image": "pred_icons/morigesh.png"
            },
            {
                "id": 21, 
                "name": "Mourn",
                "image": "pred_icons/mourn.png"
            },
            {
                "id": 22, 
                "name": "Murdock",
                "image": "pred_icons/murdock.png"
            },
            {
                "id": 23, 
                "name": "Muriel",
                "image": "pred_icons/muriel.png"
            },
            {
                "id": 24, 
                "name": "Narbash",
                "image": "pred_icons/narbash.png"
            },
            {
                "id": 25, 
                "name": "Phase",
                "image": "pred_icons/phase.png"
            },
            {
                "id": 26, 
                "name": "Rampage",
                "image": "pred_icons/rampage.png"
            },
            {
                "id": 27, 
                "name": "Revenant",
                "image": "pred_icons/revenant.png"
            },
            {
                "id": 28, 
                "name": "Riktor",
                "image": "pred_icons/riktor.png"
            },
            {
                "id": 29, 
                "name": "Serath",
                "image": "pred_icons/serath.png"
            },
            {
                "id": 30, 
                "name": "Sevarog",
                "image": "pred_icons/sevarog.png"
            },
            {
                "id": 31, 
                "name": "Shinbi",
                "image": "pred_icons/shinbi.png"
            },
            {
                "id": 32, 
                "name": "Skylar",
                "image": "pred_icons/skylar.png"
            },
            {
                "id": 33, 
                "name": "Sparrow",
                "image": "pred_icons/sparrow.png"
            },
            {
                "id": 34, 
                "name": "Steel",
                "image": "pred_icons/steel.png"
            },
            {
                "id": 35, 
                "name": "Terra",
                "image": "pred_icons/terra.png"
            },
            {
                "id": 36, 
                "name": "Twinblast",
                "image": "pred_icons/twinblast.png"
            },
            {
                "id": 37, 
                "name": "Wraith",
                "image": "pred_icons/wraith.png"
            },
            {
                "id": 38, 
                "name": "Yin",
                "image": "pred_icons/yin.png"
            },
            {
                "id": 39, 
                "name": "Zarus",
                "image": "pred_icons/zarus.png"
            },
            {
                "id": 40, 
                "name": "Zinx",
                "image": "pred_icons/zinx.png"
            },
            {
                "id": 41, 
                "name": "Boris",
                "image": "pred_icons/boris.png"
            }
        ]`;
        
        // Funzione per caricare la configurazione dei campioni
        function loadChampionsConfig(jsonConfig) {
            try {
                // Parsa il JSON
                const championsData = JSON.parse(jsonConfig);
                
                // Aggiorna la configurazione
                config.championsConfig = championsData;
                config.totalChampions = championsData.length;
                
                // Genera i campioni in base alla configurazione
                generateChampions();
                
                console.log(`Configurazione caricata: ${championsData.length} campioni`);
            } catch (error) {
                console.error('Errore nel parsing del JSON:', error);
                alert('Errore nel formato JSON. Verifica la sintassi.');
            }
        }
        
        // Mostrare il modal per l'input JSON
        function showConfigModal() {
            // Crea un modal per l'input JSON se non esiste
            let configModal = document.getElementById('configModal');
            if (!configModal) {
                configModal = document.createElement('div');
                configModal.id = 'configModal';
                configModal.className = 'modal fade';
                configModal.innerHTML = `
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content" style="background-color: var(--mid-bg); color: var(--text);">
                            <div class="modal-header">
                                <h5 class="modal-title">Configurazione Campioni</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class="alert alert-info">
                                    <strong>Nota:</strong> Il personaggio vuoto sarÃ  sempre aggiunto automaticamente all'inizio della griglia.
                                </div>
                                <p>Inserisci la configurazione JSON per i campioni:</p>
                                <textarea id="championsJson" class="form-control" rows="15" style="font-family: monospace;">${defaultChampionsJson}</textarea>
                                <div class="mt-3">
                                    <strong>Formato JSON richiesto:</strong>
                                    <pre style="background-color: #2d3748; padding: 10px; border-radius: 4px; color: #e2e8f0;">
[
    {
        "id": "id-univoco-1",
        "name": "Nome Campione 1",
        "image": "/percorso/immagine1.jpg"
    },
    {
        "id": "id-univoco-2",
        "name": "Nome Campione 2",
        "image": "/percorso/immagine2.jpg"
    }
]</pre>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                                <button type="button" class="btn btn-primary" id="saveConfigBtn">Salva Configurazione</button>
                            </div>
                        </div>
                    </div>
                `;
                document.body.appendChild(configModal);
                
                // Aggiungi il listener per il pulsante di salvataggio
                document.getElementById('saveConfigBtn').addEventListener('click', function() {
                    const jsonText = document.getElementById('championsJson').value;
                    loadChampionsConfig(jsonText);
                    bootstrap.Modal.getInstance(document.getElementById('configModal')).hide();
                });
            }
            
            // Mostra il modal
            new bootstrap.Modal(configModal).show();
        }
        
        // Aggiungi pulsante per la configurazione
        const configBtn = document.createElement('button');
        configBtn.className = 'btn-draft';
        configBtn.style.backgroundColor = '#9b59b6';
        configBtn.style.color = 'white';
        configBtn.innerHTML = '<i class="fas fa-cog me-2"></i>Config Campioni';
        configBtn.addEventListener('click', showConfigModal);
        
        // Inserisci il pulsante nei controlli
        document.querySelector('.controls').appendChild(configBtn);
        
        // Stato del draft
        const state = {
            currentPhase: 'notStarted', // notStarted, ban1, pick1, ban2, pick2, completed
            currentTeam: 'red', // red o blue
            currentTimer: 0,
            isPaused: false,
            timerInterval: null,
            selectedChampion: null,
            selectedChampions: [],
            bannedChampions: []
        };
        
        // Sequenza del draft
        const draftSequence = [
            { type: 'ban', team: 'blue', slot: 'blueBan1', phase: 'Ban - Squadra Blu' },
            { type: 'ban', team: 'red', slot: 'redBan1', phase: 'Ban - Squadra Rossa' },
            
            { type: 'pick', team: 'blue', slot: 'bluePlayer1', phase: 'Pick - Squadra Blu' },
            { type: 'pick', team: 'red', slot: 'redPlayer1', phase: 'Pick - Squadra Rossa' },
            { type: 'pick', team: 'red', slot: 'redPlayer2', phase: 'Pick - Squadra Rossa' },
            { type: 'pick', team: 'blue', slot: 'bluePlayer2', phase: 'Pick - Squadra Blu' },
            { type: 'pick', team: 'blue', slot: 'bluePlayer3', phase: 'Pick - Squadra Blu' },
            { type: 'pick', team: 'red', slot: 'redPlayer3', phase: 'Pick - Squadra Rossa' },
            
            { type: 'ban', team: 'red', slot: 'redBan2', phase: 'Ban - Squadra Rossa' },
            { type: 'ban', team: 'blue', slot: 'blueBan2', phase: 'Ban - Squadra Blu' },
            
            { type: 'pick', team: 'red', slot: 'redPlayer4', phase: 'Pick - Squadra Rossa' },
            { type: 'pick', team: 'blue', slot: 'bluePlayer4', phase: 'Pick - Squadra Blu' },
            { type: 'pick', team: 'blue', slot: 'bluePlayer5', phase: 'Pick - Squadra Blu' },
            { type: 'pick', team: 'red', slot: 'redPlayer5', phase: 'Pick - Squadra Rossa' }
        ];
        
        let currentStepIndex = 0;
        
        // Elementi DOM
        const timerEl = document.getElementById('timer');
        const phaseIndicatorEl = document.getElementById('phaseIndicator');
        const pauseBtn = document.getElementById('pauseBtn');
        const resetBtn = document.getElementById('resetBtn');
        const settingsBtn = document.getElementById('settingsBtn');
        const startBtn = document.getElementById('startBtn');
        const championsContainer = document.getElementById('championsContainer');
        
        // Funzione per caricare la configurazione dei campioni
        function loadChampionsConfig(jsonConfig) {
            try {
                // Parsa il JSON
                const championsData = JSON.parse(jsonConfig);
                
                // Aggiorna la configurazione
                config.championsConfig = championsData;
                config.totalChampions = championsData.length;
                
                // Genera i campioni in base alla configurazione
                generateChampions();
                
                console.log(`Configurazione caricata: ${championsData.length} campioni`);
            } catch (error) {
                console.error('Errore nel parsing del JSON:', error);
                alert('Errore nel formato JSON. Verifica la sintassi.');
            }
        }
        
        // Generare champions in base alla configurazione JSON
        function generateChampions() {
            championsContainer.innerHTML = '';
            
            // Aggiungiamo sempre prima il personaggio "vuoto" che puÃ² essere selezionato piÃ¹ volte
            const emptyChampionCard = document.createElement('div');
            emptyChampionCard.className = 'champion-card empty-champion';
            emptyChampionCard.dataset.id = 'empty';
            emptyChampionCard.dataset.reusable = 'true';
            
            // Utilizziamo un'icona o immagine speciale per il pg vuoto
            emptyChampionCard.innerHTML = `
                <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%;">
                    <i class="fas fa-user-plus" style="font-size: 2rem; color: #aaa;"></i>
                    <div style="margin-top: 5px; font-size: 0.8rem;">PG Vuoto</div>
                </div>
            `;
            
            emptyChampionCard.addEventListener('click', handleChampionClick);
            championsContainer.appendChild(emptyChampionCard);
            
            // Se non ci sono campioni configurati, usa la generazione predefinita
            if (!config.championsConfig || config.championsConfig.length === 0) {
                // Aggiungiamo campioni generici
                for (let i = 1; i <= config.totalChampions; i++) {
                    const championCard = document.createElement('div');
                    championCard.className = 'champion-card';
                    championCard.dataset.id = i;
                    
                    // Utilizziamo immagini placeholder per ora
                    championCard.innerHTML = `
                        <img src="/api/placeholder/80/80" alt="Champion ${i}">
                    `;
                    
                    championCard.addEventListener('click', handleChampionClick);
                    
                    championsContainer.appendChild(championCard);
                }
            } else {
                // Utilizziamo la configurazione JSON (saltando eventuali PG vuoti definiti nel JSON)
                config.championsConfig.forEach(champion => {
                    // Saltiamo eventuali definizioni del PG vuoto nel JSON perchÃ© l'abbiamo giÃ  aggiunto
                    if (champion.id === 'empty' || champion.reusable === true) {
                        return;
                    }
                    
                    const championCard = document.createElement('div');
                    championCard.className = 'champion-card';
                    championCard.dataset.id = champion.id;
                    
                    // Se c'Ã¨ un'immagine, la usiamo, altrimenti un'icona placeholder
                    if (champion.image) {
                        championCard.innerHTML = `
                            <img src="${champion.image}" alt="${champion.name}">
                            <div style="position: absolute; bottom: 0; left: 0; right: 0; background-color: rgba(0, 0, 0, 0.7); 
                                  padding: 5px; text-align: center; font-size: 0.8rem;">${champion.name}</div>
                        `;
                    } else {
                        // Per campioni senza immagine
                        championCard.innerHTML = `
                            <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%;">
                                <i class="fas fa-user" style="font-size: 2rem; color: #aaa;"></i>
                                <div style="margin-top: 5px; font-size: 0.8rem;">${champion.name}</div>
                            </div>
                        `;
                    }
                    
                    championCard.addEventListener('click', handleChampionClick);
                    championsContainer.appendChild(championCard);
                });
            }
        }
        
        // Gestire il click su un campione
        function handleChampionClick(event) {
            if (state.currentPhase === 'notStarted' || state.currentPhase === 'completed' || state.isPaused) {
                return;
            }
            
            const championEl = event.currentTarget;
            const championId = championEl.dataset.id;
            const isReusable = championEl.dataset.reusable === 'true';
            
            // Verificare se il campione Ã¨ giÃ  stato selezionato o bannato
            // ma SOLO se non Ã¨ un campione riutilizzabile
            if (!isReusable && (state.selectedChampions.includes(championId) || state.bannedChampions.includes(championId))) {
                return;
            }
            
            // Deselezionare il campione precedentemente selezionato
            document.querySelectorAll('.champion-card.selected').forEach(el => {
                el.classList.remove('selected');
            });
            
            // Selezionare il nuovo campione
            championEl.classList.add('selected');
            state.selectedChampion = {
                id: championId,
                element: championEl,
                isReusable: isReusable
            };
            
            // Nel caso di una selezione automatica, confermiamo immediatamente
            confirmSelection();
        }
        
        // Confermare la selezione
        function confirmSelection() {
            if (!state.selectedChampion) {
                return;
            }
            
            const currentStep = draftSequence[currentStepIndex];
            
            // Trova il nome del campione selezionato
            let championName = "PG Vuoto"; // Default per il PG vuoto
            
            // Se Ã¨ un campione del JSON config, cerca il suo nome
            if (!state.selectedChampion.isReusable && config.championsConfig) {
                const champion = config.championsConfig.find(c => c.id.toString() === state.selectedChampion.id.toString());
                if (champion) {
                    championName = champion.name;
                }
            }
            
            if (currentStep.type === 'pick') {
                // Selezionare un campione
                if (!state.selectedChampion.isReusable) {
                    state.selectedChampions.push(state.selectedChampion.id);
                }
                
                const slotEl = document.getElementById(currentStep.slot);
                slotEl.innerHTML = `
                    <img src="${state.selectedChampion.element.querySelector('img')?.src || '/api/placeholder/100/100'}" alt="${championName}">
                    <div class="hero-name">${championName}</div>
                `;
                slotEl.classList.add('selected');
                
                // Disabilita il campione solo se non Ã¨ riutilizzabile
                if (!state.selectedChampion.isReusable) {
                    state.selectedChampion.element.classList.add('disabled');
                }
                
            } else {
                // Bannare un campione
                if (!state.selectedChampion.isReusable) {
                    state.bannedChampions.push(state.selectedChampion.id);
                }
                
                const slotEl = document.getElementById(currentStep.slot);
                slotEl.innerHTML = `
                    <img src="${state.selectedChampion.element.querySelector('img')?.src || '/api/placeholder/180/180'}" alt="${championName}">
                    <div class="ban-name">${championName}</div>
                `;
                slotEl.classList.add('banned');
                
                // Disabilita il campione solo se non Ã¨ riutilizzabile
                if (!state.selectedChampion.isReusable) {
                    state.selectedChampion.element.classList.add('disabled');
                }
            }
            
            // Resettare il campione selezionato
            state.selectedChampion = null;
            
            // Passare al prossimo step
            moveToNextStep();
        }
        
        // Passare al prossimo step
        function moveToNextStep() {
            currentStepIndex++;
            
            if (currentStepIndex >= draftSequence.length) {
                // Draft completato
                completeDraft();
                return;
            }
            
            // Aggiornare l'UI per il nuovo step
            updateCurrentStep();
        }
        
        // Aggiornare l'UI per lo step corrente
        function updateCurrentStep() {
            // Rimuovere il focus dallo step precedente
            document.querySelectorAll('.player-slot.active, .ban-slot.active').forEach(el => {
                el.classList.remove('active');
            });
            
            const currentStep = draftSequence[currentStepIndex];
            state.currentTeam = currentStep.team;
            
            // Impostare il tempo in base al tipo di step
            if (currentStep.type === 'ban') {
                state.currentTimer = config.timePerBan;
                state.currentPhase = 'ban';
            } else {
                state.currentTimer = config.timePerPick;
                state.currentPhase = 'pick';
            }
            
            // Aggiornare la fase
            phaseIndicatorEl.textContent = currentStep.phase;
            
            // Evidenziare lo slot corrente
            const slotEl = document.getElementById(currentStep.slot);
            slotEl.classList.add('active');
            
            // Aggiornare il timer
            updateTimerDisplay();
            
            // Riavviare il timer
            resetTimer();
        }
        
        // Aggiornare il display del timer
        function updateTimerDisplay() {
            timerEl.textContent = state.currentTimer + " secondi";
            
            // Aggiornare le classi di avviso
            timerEl.classList.remove('warning', 'danger');
            
            if (state.currentTimer <= 5) {
                timerEl.classList.add('danger');
            } else if (state.currentTimer <= 10) {
                timerEl.classList.add('warning');
            }
        }
        
        // Avviare il timer
        function startTimer() {
            // Prima di avviare un nuovo timer, assicuriamoci di cancellare quello precedente
            if (state.timerInterval) {
                clearInterval(state.timerInterval);
            }
            
            // Creiamo un nuovo timer solo se non siamo in pausa
            if (!state.isPaused) {
                state.timerInterval = setInterval(() => {
                    state.currentTimer--;
                    updateTimerDisplay();
                    
                    if (state.currentTimer <= 0) {
                        // Tempo scaduto, fermiamo il timer
                        clearInterval(state.timerInterval);
                        state.timerInterval = null;
                        
                        // Selezione automatica casuale
                        autoSelectChampion();
                    }
                }, 1000);
            }
        }
        
        // Selezione automatica di un campione
        function autoSelectChampion() {
            // Ottenere tutti i campioni non ancora selezionati o bannati
            const availableChampions = Array.from(document.querySelectorAll('.champion-card:not(.disabled)'));
            
            if (availableChampions.length > 0) {
                // Seleziona un campione casuale tra quelli disponibili
                const randomIndex = Math.floor(Math.random() * availableChampions.length);
                const randomChampion = availableChampions[randomIndex];
                
                // Deseleziona qualsiasi campione attualmente selezionato
                document.querySelectorAll('.champion-card.selected').forEach(el => {
                    el.classList.remove('selected');
                });
                
                // Seleziona il campione casuale
                randomChampion.classList.add('selected');
                
                // Imposta il campione selezionato nello stato
                state.selectedChampion = {
                    id: randomChampion.dataset.id,
                    element: randomChampion
                };
                
                // Conferma la selezione automaticamente
                confirmSelection();
            } else {
                // Nel caso improbabile che non ci siano campioni disponibili
                console.error('Nessun campione disponibile per la selezione automatica');
                moveToNextStep();
            }
        }
        
        // Reimpostare il timer
        function resetTimer() {
            if (state.timerInterval) {
                clearInterval(state.timerInterval);
            }
            
            startTimer();
        }
        
        // Completare il draft
        function completeDraft() {
            state.currentPhase = 'completed';
            
            if (state.timerInterval) {
                clearInterval(state.timerInterval);
            }
            
            phaseIndicatorEl.textContent = 'Draft Completato';
            timerEl.textContent = '0';
            
            // Rimuovere tutti gli active
            document.querySelectorAll('.player-slot.active, .ban-slot.active').forEach(el => {
                el.classList.remove('active');
            });
            
            // Mostrare il pulsante di inizia
            startBtn.textContent = 'NUOVO DRAFT';
            startBtn.style.display = 'block';
        }
        
        // Avviare il draft
        function startDraft() {
            state.currentPhase = 'inProgress';
            currentStepIndex = 0;
            state.selectedChampions = [];
            state.bannedChampions = [];
            state.isPaused = false;
            
            // Nascondere il pulsante di inizia
            startBtn.style.display = 'none';
            
            // Resettare tutti gli slot
            document.querySelectorAll('.player-slot, .ban-slot').forEach(el => {
                el.classList.remove('active', 'selected', 'banned');
                el.innerHTML = `<img src="/api/placeholder/${el.classList.contains('ban-slot') ? '40/40' : '100/100'}" alt="Slot">`;
            });
            
            // Resettare i campioni
            document.querySelectorAll('.champion-card').forEach(el => {
                el.classList.remove('disabled', 'selected');
            });
            
            updateCurrentStep();
        }
        
        // Reset del draft
        function resetDraft() {
            if (confirm('Sei sicuro di voler resettare il draft?')) {
                state.currentPhase = 'notStarted';
                
                if (state.timerInterval) {
                    clearInterval(state.timerInterval);
                }
                
                phaseIndicatorEl.textContent = 'In attesa di inizio';
                timerEl.textContent = '0 secondi';
                
                // Resettare tutti gli slot
                document.querySelectorAll('.player-slot, .ban-slot').forEach(el => {
                    el.classList.remove('active', 'selected', 'banned');
                    el.innerHTML = `<img src="/api/placeholder/${el.classList.contains('ban-slot') ? '180/180' : '100/100'}" alt="Slot">`;
                });
                
                // Resettare i campioni
                document.querySelectorAll('.champion-card').forEach(el => {
                    el.classList.remove('disabled', 'selected');
                });
                
                // Mostrare il pulsante di inizia
                startBtn.textContent = 'INIZIA DRAFT';
                startBtn.style.display = 'block';
            }
        }
        
        // Gestire la pausa/ripresa
        function togglePause() {
            // Verifica se il draft Ã¨ in corso o giÃ  in pausa
            if (state.currentPhase === 'notStarted' || state.currentPhase === 'completed') {
                startDraft(); // Se non Ã¨ iniziato, lo avvia
                return;
            }
            
            // Inverte lo stato di pausa
            state.isPaused = !state.isPaused;
            
            if (state.isPaused) {
                // Attivazione pausa
                pauseBtn.innerHTML = '<i class="fas fa-play me-2"></i>Riprendi';
                phaseIndicatorEl.textContent += ' (In Pausa)';
                // Salva lo stato del timer
                clearInterval(state.timerInterval);
                state.timerInterval = null;
            } else {
                // Ripresa del gioco
                pauseBtn.innerHTML = '<i class="fas fa-pause me-2"></i>Pausa';
                phaseIndicatorEl.textContent = phaseIndicatorEl.textContent.replace(' (In Pausa)', '');
                // Riavvia il timer da dove era stato interrotto
                startTimer();
            }
        }
        
        // Salvare le impostazioni
        function saveSettings() {
            const timePerPick = parseInt(document.getElementById('timePerPick').value);
            const timePerBan = parseInt(document.getElementById('timePerBan').value);
            
            if (timePerPick >= 5 && timePerPick <= 120) {
                config.timePerPick = timePerPick;
            }
            
            if (timePerBan >= 5 && timePerBan <= 60) {
                config.timePerBan = timePerBan;
            }
            
            // Chiudere il modal
            bootstrap.Modal.getInstance(document.getElementById('settingsModal')).hide();
            
            // Se siamo nel mezzo di un draft, aggiornare il timer per lo step corrente
            if (state.currentPhase !== 'notStarted' && state.currentPhase !== 'completed') {
                const currentStep = draftSequence[currentStepIndex];
                
                if (currentStep.type === 'ban') {
                    state.currentTimer = config.timePerBan;
                } else {
                    state.currentTimer = config.timePerPick;
                }
                
                updateTimerDisplay();
            }
        }
        
        // Event listeners
        pauseBtn.addEventListener('click', togglePause);
        resetBtn.addEventListener('click', resetDraft);
        startBtn.addEventListener('click', startDraft);
        
        // Modal di impostazioni
        settingsBtn.addEventListener('click', () => {
            document.getElementById('timePerPick').value = config.timePerPick;
            document.getElementById('timePerBan').value = config.timePerBan;
            
            new bootstrap.Modal(document.getElementById('settingsModal')).show();
        });
        
        document.getElementById('saveSettings').addEventListener('click', saveSettings);
        
        // Inizializzazione
        // Carica la configurazione predefinita
        loadChampionsConfig(defaultChampionsJson);
        
        // Per test: mostra il modal di configurazione quando richiesto
        // showConfigModal();
    </script>
</body>
</html>